#!/bin/bash

# Скрипт для создания нагрузки на приложение
echo "Нагрузочное тестирование приложения с утечкой памяти..."

for i in {1..500}; do
    # Случайный размер от 100 KB до 2 MB
    size=$((RANDOM % 2000 + 100))
    curl -s "http://localhost:8080/leak?size=$size" > /dev/null

    # Каждые 50 запросов выводим информацию
    if (( i % 50 == 0 )); then
        echo "Запрос $i:"
        curl -s "http://localhost:8080/info"
        echo ""
    fi

    # Случайная задержка между запросами
    sleep 0.1
done

echo "Нагрузочное тестирование завершено!"